<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Flappy Bird افقی</title>
<style>
  html, body {
    margin: 0; padding: 0; overflow: hidden; height: 100%;
    background: #87ceeb;
  }
  canvas {
    display: block;
    background: #000;
    touch-action: none;
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

const BG_IMG_SRC = "https://s6.uupload.ir/files/how-would-you-describe-this-angry-birds-background-v0-9rpwenf2y3nd1_0nx2.png";
let bgImg = new Image();
bgImg.src = BG_IMG_SRC;

class Cloud {
  constructor(x, y, speed) {
    this.x = x;
    this.y = y;
    this.speed = speed;
    this.radius = 20 + Math.random() * 15;
  }
  update() {
    this.x -= this.speed;
    if (this.x + this.radius * 2 < 0) {
      this.x = canvas.width + this.radius * 2;
      this.y = Math.random() * (canvas.height / 3);
    }
  }
  draw() {
    ctx.fillStyle = "rgba(255,255,255,0.8)";
    ctx.beginPath();
    ctx.ellipse(this.x, this.y, this.radius * 1.5, this.radius, 0, 0, Math.PI * 2);
    ctx.fill();
  }
}

class Obstacle {
  constructor(x, y, width, height, speed) {
    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;
    this.speed = speed;
  }
  update() {
    this.x -= this.speed;
    if (this.x + this.width < 0) {
      this.x = canvas.width + Math.random() * 200;
      this.y = Math.random() * (canvas.height - 100) + 50;
      this.height = 40 + Math.random() * 100;
    }
  }
  draw() {
    ctx.fillStyle = "#228B22";
    ctx.fillRect(this.x, this.y, this.width, this.height);
  }
}

class Bird {
  constructor() {
    this.x = canvas.width / 5;
    this.y = canvas.height / 2;
    this.radius = 15;
    this.gravity = 0.6;
    this.lift = -12;
    this.velocity = 0;
  }
  update() {
    this.velocity += this.gravity;
    this.y += this.velocity;

    if (this.y + this.radius > canvas.height) {
      this.y = canvas.height - this.radius;
      this.velocity = 0;
    }
    if (this.y - this.radius < 0) {
      this.y = this.radius;
      this.velocity = 0;
    }
  }
  draw() {
    ctx.fillStyle = "#FF4500";
    ctx.beginPath();
    ctx.ellipse(this.x, this.y, this.radius * 1.5, this.radius, 0, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = "#000";
    ctx.beginPath();
    ctx.arc(this.x + 5, this.y - 5, 4, 0, Math.PI * 2);
    ctx.fill();
  }
  flap() {
    this.velocity = this.lift;
  }
}

let bird = new Bird();

let clouds = [];
for (let i = 0; i < 8; i++) {
  clouds.push(new Cloud(Math.random() * canvas.width, Math.random() * (canvas.height / 3), 0.3 + Math.random() * 0.3));
}

let obstacles = [];
for (let i = 0; i < 4; i++) {
  let x = canvas.width + i * 250;
  let y = Math.random() * (canvas.height - 150) + 50;
  let height = 50 + Math.random() * 100;
  obstacles.push(new Obstacle(x, y, 40, height, 3));
}

// کنترل پرنده با لمس و کلیک
canvas.addEventListener("touchstart", (e) => {
  e.preventDefault();
  bird.flap();
}, {passive: false});

canvas.addEventListener("mousedown", () => bird.flap());

function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);

  clouds.forEach(cloud => {
    cloud.update();
    cloud.draw();
  });

  obstacles.forEach(obstacle => {
    obstacle.update();
    obstacle.draw();
  });

  bird.update();
  bird.draw();

  requestAnimationFrame(gameLoop);
}

bgImg.onload = () => {
  gameLoop();
};
</script>
</body>
</html>
