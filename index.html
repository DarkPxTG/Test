<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Flappy Bird Horizontal</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #70c5ce;
      font-family: Arial, sans-serif;
    }
    canvas {
      display: block;
      margin: 0 auto;
      background: linear-gradient(to bottom, #70c5ce 0%, #ffffff 100%);
    }
    #timer {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 30px;
      color: #fff;
      font-weight: bold;
      text-shadow: 1px 1px 2px #000;
    }
  </style>
</head>
<body>
  <div id="timer">0</div>
  <canvas id="game" width="800" height="400"></canvas>
  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    let bird = { x: 100, y: 150, width: 40, height: 40, velocity: 0, gravity: 0.5, jump: -8 };
    let pipes = [];
    let frame = 0;
    let timer = 0;
    let gap = 140;
    let pipeSpeed = 3;

    const timerElement = document.getElementById("timer");
    setInterval(() => {
      timer++;
      timerElement.textContent = timer;
    }, 500); // تایمر سریع

    function resetGame() {
      bird.y = 150;
      bird.velocity = 0;
      pipes = [];
      frame = 0;
      timer = 0;
      gap = 140;
      pipeSpeed = 3;
    }

    function drawBird() {
      ctx.fillStyle = "yellow";
      ctx.beginPath();
      ctx.arc(bird.x, bird.y, bird.width / 2, 0, Math.PI * 2);
      ctx.fill();
    }

    function drawPipes() {
      ctx.fillStyle = "green";
      for (let i = 0; i < pipes.length; i++) {
        let p = pipes[i];
        ctx.fillRect(p.x, 0, 50, p.top);
        ctx.fillRect(p.x, p.top + gap, 50, canvas.height - p.top - gap);
      }
    }

    function updatePipes() {
      if (frame % 90 === 0) {
        let top = Math.random() * (canvas.height - gap - 80) + 20;
        pipes.push({ x: canvas.width, top: top });
        // افزایش سختی تدریجی
        if (gap > 100) gap -= 1;
        if (pipeSpeed < 8) pipeSpeed += 0.05;
      }

      for (let i = 0; i < pipes.length; i++) {
        pipes[i].x -= pipeSpeed;

        if (
          bird.x + bird.width / 2 > pipes[i].x &&
          bird.x - bird.width / 2 < pipes[i].x + 50 &&
          (bird.y - bird.height / 2 < pipes[i].top ||
            bird.y + bird.height / 2 > pipes[i].top + gap)
        ) {
          resetGame();
        }
      }

      pipes = pipes.filter(p => p.x + 50 > 0);
    }

    function updateBird() {
      bird.velocity += bird.gravity;
      bird.y += bird.velocity;

      if (bird.y + bird.height / 2 >= canvas.height || bird.y - bird.height / 2 <= 0) {
        resetGame();
      }
    }

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawBird();
      drawPipes();
      updateBird();
      updatePipes();
      frame++;
      requestAnimationFrame(gameLoop);
    }

    document.addEventListener("keydown", (e) => {
      if (e.code === "Space" || e.code === "ArrowUp") {
        bird.velocity = bird.jump;
      }
    });

    gameLoop();
  </script>
</body>
</html>
