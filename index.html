<!DOCTYPE html><html lang="fa">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Flappy Bird افقی حرفه‌ای</title>
<style>
  html, body {
    margin: 0; padding: 0; overflow: hidden; height: 100%;
    background: #000;
    font-family: 'Vazir', sans-serif;
  }
  #gameCanvas {
    display: block;
    background: url('https://s6.uupload.ir/files/how-would-you-describe-this-angry-birds-background-v0-9rpwenf2y3nd1_0nx2.png') no-repeat center center;
    background-size: cover;
    width: 100vw;
    height: 100vh;
    touch-action: none;
    position: relative;
    z-index: 1;
  }
  #rotateScreen {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.7);
    color: #fff;
    font-size: 18px;
    font-weight: 600;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding: 12px 20px;
    border-radius: 10px;
    text-shadow: 0 0 8px #ff0000, 0 0 16px #ff0000;
    z-index: 1200;
    text-align: center;
    display: none;
  }
  #loading {
    position: fixed; top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    font-size: 36px; color: #ff3f3f;
    font-weight: 900;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    text-shadow:
      0 0 15px #ff3f3f,
      0 0 30px #ff3f3f,
      0 0 40px #ff3f3f,
      0 0 60px #ff3f3f;
    letter-spacing: 6px;
    display: none;
    z-index: 1100;
    user-select: none;
  }
  @keyframes wave {
    0%, 100% { text-shadow: 0 0 15px #ff3f3f; }
    50% { text-shadow: 0 0 30px #ff0000, 0 0 40px #ff0000; }
  }
  #loading span {
    display: inline-block;
    animation: wave 1.5s infinite ease-in-out;
  }
  #bloodOverlay {
    position: fixed; top:0; left:0; width:100vw; height:100vh;
    pointer-events:none;
    z-index: 1300;
    mix-blend-mode: multiply;
  }
  #gameTimer {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 22px;
    color: #fff;
    font-weight: bold;
    font-family: 'Courier New', Courier, monospace;
    text-shadow: 0 0 8px #ff0000;
    z-index: 1100;
    user-select: none;
    display: none;
  }
</style>
</head>
<body><canvas id="gameCanvas"></canvas>

<div id="rotateScreen">Please rotate your device for the ultimate experience</div>
<div id="loading"></div>
<canvas id="bloodOverlay"></canvas>
<div id="gameTimer">0:00</div><script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const rotateScreen = document.getElementById('rotateScreen');
  const loading = document.getElementById('loading');
  const bloodCanvas = document.getElementById('bloodOverlay');
  const bloodCtx = bloodCanvas.getContext('2d');
  const timerElement = document.getElementById('gameTimer');

  let timerInterval;
  let elapsedSeconds = 0;

  function startTimer() {
    elapsedSeconds = 0;
    updateTimerDisplay();
    timerElement.style.display = 'block';
    timerInterval = setInterval(() => {
      elapsedSeconds++;
      updateTimerDisplay();
    }, 1000);
  }

  function stopTimer() {
    clearInterval(timerInterval);
    timerElement.style.display = 'none';
  }

  function updateTimerDisplay() {
    const minutes = Math.floor(elapsedSeconds / 60);
    const seconds = elapsedSeconds % 60;
    timerElement.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
  }
</script><!-- ادامه اسکریپت اصلی بدون تغییر، فقط در شروع بازی startTimer و در پایان stopTimer اضافه خواهد شد --><script>
  // ... همه کدهای بازی بدون تغییر ...

  function startGame(){
    bird = new Bird();
    bird.isMoving = true;
    obstacles = [];
    bloodParticles.length = 0;
    gameStarted = true;
    gameOver = false;
    score = 0;
    difficultyIncrement = 0;
    speed = 2.2;
    startTimer(); // تایمر شروع شود

    let startX = W + 200;
    for(let i=0; i<4; i++){
      let gapSize = 140;
      let hTop = Math.random()*(H - gapSize - 100) + 50;
      obstacles.push(new Obstacle(startX + i*250, 60, hTop, gapSize));
    }
  }

  function gameLoop(){
    ctx.clearRect(0,0,W,H);

    obstacles.forEach(ob => {
      ob.update();
      ob.draw();
      if(ob.checkCollision(bird) && !bird.dead){
        bird.dead = true;
        gameOver = true;
        createBloodFountain(bird.x, bird.y);
        shakeScreen();
      }
    });

    bird.update();
    bird.draw();

    if(gameOver){
      updateBloodParticles();
    }

    if(!gameOver && gameStarted){
      requestAnimationFrame(gameLoop);
    } else if(gameOver){
      stopTimer(); // تایمر متوقف شود
      setTimeout(() => {
        gameStarted = false;
        showLoadingAnimation(() => {
          startGame();
          gameLoop();
        });
      }, 2500);
    }
  }
</script></body>
</html>
